<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Anuncios</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="createAnuncio()">
        <ion-icon name="add-circle" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="anuncios-container">
    <!-- Loading -->
    <div *ngIf="loading" class="loading-container">
      <ion-spinner></ion-spinner>
      <p>Cargando anuncios...</p>
    </div>

    <!-- Lista de anuncios -->
    <div *ngIf="!loading && anuncios.length > 0" class="anuncios-list">
      <ion-card *ngFor="let anuncio of anuncios" class="anuncio-card">
        <!-- Imagen del anuncio -->
        <img 
          *ngIf="anuncio.imageUrl" 
          [src]="anuncio.imageUrl" 
          [alt]="anuncio.title"
          class="anuncio-image">

        <ion-card-header>
          <div class="anuncio-header">
            <ion-avatar class="author-avatar">
              <img [src]="anuncio.authorPhoto || 'https://ionicframework.com/docs/img/demos/avatar.svg'">
            </ion-avatar>
            <div class="author-info">
              <ion-card-subtitle>{{ anuncio.authorName }}</ion-card-subtitle>
              <ion-badge [color]="anuncio.authorRole === 'conserje' ? 'secondary' : 'primary'">
                {{ anuncio.authorRole === 'conserje' ? 'Conserje' : 'Residente' }}
              </ion-badge>
            </div>
          </div>
          <ion-card-title>{{ anuncio.title }}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <p class="anuncio-description">{{ anuncio.description }}</p>
          
          <div class="anuncio-footer">
            <div class="anuncio-date">
              <ion-icon name="calendar-outline"></ion-icon>
              <span>{{ anuncio.createdAt | date:'dd/MM/yyyy HH:mm' }}</span>
            </div>
            
            <ion-badge 
              *ngIf="anuncio.category" 
              [color]="getCategoryColor(anuncio.category)">
              {{ getCategoryLabel(anuncio.category) }}
            </ion-badge>
          </div>

          <!-- Botón eliminar (solo si es el autor) -->
          <ion-button 
            *ngIf="anuncio.authorId === currentUserId"
            expand="block" 
            fill="clear" 
            color="danger"
            size="small"
            (click)="deleteAnuncio(anuncio)">
            <ion-icon name="trash" slot="start"></ion-icon>
            Eliminar
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Sin anuncios -->
<!-- Sin anuncios -->
<div *ngIf="!loading && anuncios.length === 0" class="empty-state">
  <ion-icon name="megaphone-outline"></ion-icon>
  <h2>No hay anuncios</h2>
  <p>Sé el primero en publicar un anuncio<br>en tu comunidad</p>
  <ion-button (click)="createAnuncio()" shape="round" size="large">
    <ion-icon name="add-circle" slot="start"></ion-icon>
    Crear Anuncio
  </ion-button>
</div>
  </div>
</ion-content>